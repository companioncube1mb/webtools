<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Progress - æ™‚é–“ã®çµŒéã‚’è¦–è¦šåŒ– | å¹´ãƒ»æœˆãƒ»é€±ã®é€²æ—ãƒˆãƒ©ãƒƒã‚«ãƒ¼</title>
    
    <meta name="description" content="ç¾åœ¨ã®å¹´ã€æœˆã€é€±ã€æ—¥ã®é€²æ—ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¦–è¦šåŒ–ã™ã‚‹ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒƒã‚«ãƒ¼ã€‚ã‚«ã‚¹ã‚¿ãƒ ç›®æ¨™æ—¥æ™‚ã®é€²æ—ã‚‚è¿½è·¡ã§ãã¾ã™ã€‚">
    <meta name="keywords" content="æ™‚é–“ç®¡ç†, ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒƒã‚«ãƒ¼, é€²æ—ãƒãƒ¼, ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼, å¹´é–“è¨ˆç”», ç›®æ¨™è¨­å®š, Time Progress">
    <meta name="author" content="Your Name">
    <meta property="og:title" content="Time Progress - æ™‚é–“ã®çµŒéã‚’è¦–è¦šåŒ–">
    <meta property="og:description" content="ç¾åœ¨ã®å¹´ã€æœˆã€é€±ã€æ—¥ã®é€²æ—ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¦–è¦šåŒ–ã™ã‚‹ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒƒã‚«ãƒ¼ã€‚">
    <meta property="og:type" content="website">
    <meta property="og:url" content="YOUR_SITE_URL">
    <link rel="canonical" href="YOUR_SITE_URL">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            max-width: 800px;
            width: 100%;
        }

        /* è¨€èªåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-weight: 200;
            font-size: clamp(1.5rem, 4vw, 2rem);
        }
        
        .lang-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* ç¾åœ¨æ™‚åˆ»è¡¨ç¤º */
        .current-time {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .time-display {
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 200;
            margin-bottom: 10px;
            font-variant-numeric: tabular-nums;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .date-display {
            font-size: 1.2rem;
            opacity: 0.8;
            font-weight: 300;
        }

        /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚«ãƒ¼ãƒ‰ */
        .progress-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .progress-card:hover {
            transform: translateY(-2px);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .progress-title {
            font-size: 1.2rem;
            font-weight: 300;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-icon {
            font-size: 1.5rem;
        }

        .progress-value {
            font-size: 1.8rem;
            font-weight: 200;
            font-variant-numeric: tabular-nums;
        }

        .progress-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */
        .progress-bar-container {
            width: 100%;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 0;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 0;
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
        }

        /* å…‰æ²¢ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.2), transparent);
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .shine {
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* å„æ™‚é–“å¸¯ã®è‰²åˆ†ã‘ */
        .progress-bar.year {
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4);
        }

        .progress-bar.month {
            background: linear-gradient(90deg, #95E1D3, #3D5A80);
        }

        .progress-bar.week {
            background: linear-gradient(90deg, #F4A261, #E76F51);
        }

        .progress-bar.day {
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .progress-bar.hour {
            background: linear-gradient(90deg, #56CCF2, #2F80ED);
        }

        /* ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ãƒãƒ¼ã‚«ãƒ¼ */
        .milestones {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }

        .milestone {
            position: absolute;
            width: 1px;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            top: 0;
        }

        .milestone.quarter { left: 25%; }
        .milestone.half { left: 50%; width: 2px; background: rgba(255, 255, 255, 0.3); }
        .milestone.three-quarter { left: 75%; }

        /* çµ±è¨ˆæƒ…å ± */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 200;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .progress-card {
                padding: 15px;
            }
            
            .progress-value {
                font-size: 1.5rem;
            }
            
            .progress-title {
                font-size: 1rem;
            }
            
            .progress-bar-container {
                height: 35px;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 400px) {
            .progress-details {
                font-size: 0.8rem;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }
        
        /* ãƒ•ã‚©ãƒ¼ãƒ ã®å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
        .form-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px;
            border-radius: 10px;
            flex: 1;
            min-width: 200px;
        }
        
        /* datetime-localã®çŸ¢å°ã®è‰²ã‚’ç™½ãã™ã‚‹ */
        input[type="datetime-local"] {
            color-scheme: dark; 
        }

        .form-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 8px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="title">ğŸ“Š æ™‚é–“ã®çµŒé</h1>
            <button class="lang-btn" id="langBtn">ğŸŒ English</button>
        </div>
        
        <div class="current-time" style="margin-bottom: 20px;">
            <div style="display: flex; gap: 20px; align-items: center; justify-content: center; flex-wrap: wrap;">
                <div>
                    <label for="weekStartDay" style="font-size: 0.9rem; opacity: 0.8;" id="weekStartLabel">é€±ã®é–‹å§‹æ›œæ—¥:</label>
                    <select id="weekStartDay" style="
                        background: rgba(30, 30, 50, 0.9);
                        border: 1px solid rgba(255, 255, 255, 0.2);
                        color: white;
                        padding: 5px 10px;
                        border-radius: 10px;
                        margin-left: 10px;
                        cursor: pointer;
                    ">
                        <option value="1" style="background: #2a2a3e; color: white;">æœˆæ›œæ—¥</option>
                        <option value="0" style="background: #2a2a3e; color: white;">æ—¥æ›œæ—¥</option>
                        <option value="6" style="background: #2a2a3e; color: white;">åœŸæ›œæ—¥</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="current-time">
            <div class="time-display" id="currentTime">--:--:--</div>
            <div class="date-display" id="currentDate">----å¹´--æœˆ--æ—¥</div>
        </div>
        
        <div class="progress-card">
            <div class="progress-header">
                <div class="progress-title">
                    <span class="progress-icon">ğŸ“…</span>
                    <span id="yearTitle">ä»Šå¹´</span>
                </div>
                <div class="progress-value" id="yearPercent">--%</div>
            </div>
            <div class="progress-details">
                <span id="yearStart">1æœˆ1æ—¥ã‹ã‚‰</span>
                <span id="yearProgress">---æ—¥çµŒé</span>
                <span id="yearRemaining">æ®‹ã‚Š---æ—¥</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar year" id="yearBar" style="width: 0%">
                    <div class="shine"></div>
                </div>
                <div class="milestones">
                    <div class="milestone quarter"></div>
                    <div class="milestone half"></div>
                    <div class="milestone three-quarter"></div>
                </div>
            </div>
        </div>
        
        <div class="progress-card">
            <div class="progress-header">
                <div class="progress-title">
                    <span class="progress-icon">ğŸ—“ï¸</span>
                    <span id="monthTitle">ä»Šæœˆ</span>
                </div>
                <div class="progress-value" id="monthPercent">--%</div>
            </div>
            <div class="progress-details">
                <span id="monthStart">-æœˆ1æ—¥ã‹ã‚‰</span>
                <span id="monthProgress">--æ—¥çµŒé</span>
                <span id="monthRemaining">æ®‹ã‚Š--æ—¥</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar month" id="monthBar" style="width: 0%">
                    <div class="shine"></div>
                </div>
                <div class="milestones">
                    <div class="milestone quarter"></div>
                    <div class="milestone half"></div>
                    <div class="milestone three-quarter"></div>
                </div>
            </div>
        </div>
        
        <div class="progress-card">
            <div class="progress-header">
                <div class="progress-title">
                    <span class="progress-icon">ğŸ“†</span>
                    <span id="weekTitle">ä»Šé€±</span>
                </div>
                <div class="progress-value" id="weekPercent">--%</div>
            </div>
            <div class="progress-details">
                <span id="weekStart">æœˆæ›œã‹ã‚‰</span>
                <span id="weekProgress">--æ—¥çµŒé</span>
                <span id="weekRemaining">æ®‹ã‚Š--æ—¥</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar week" id="weekBar" style="width: 0%">
                    <div class="shine"></div>
                </div>
                <div class="milestones">
                    <div class="milestone quarter"></div>
                    <div class="milestone half"></div>
                    <div class="milestone three-quarter"></div>
                </div>
            </div>
        </div>
        
        <div class="progress-card">
            <div class="progress-header">
                <div class="progress-title">
                    <span class="progress-icon">â˜€ï¸</span>
                    <span id="dayTitle">ä»Šæ—¥</span>
                </div>
                <div class="progress-value" id="dayPercent">--%</div>
            </div>
            <div class="progress-details">
                <span id="dayStart">0:00ã‹ã‚‰</span>
                <span id="dayProgress">--æ™‚é–“çµŒé</span>
                <span id="dayRemaining">æ®‹ã‚Š--æ™‚é–“</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar day" id="dayBar" style="width: 0%">
                    <div class="shine"></div>
                </div>
                <div class="milestones">
                    <div class="milestone quarter"></div>
                    <div class="milestone half"></div>
                    <div class="milestone three-quarter"></div>
                </div>
            </div>
        </div>
        
        <div class="progress-card">
            <div class="progress-header">
                <div class="progress-title">
                    <span class="progress-icon">â°</span>
                    <span id="hourTitle">ç¾åœ¨ã®æ™‚é–“</span>
                </div>
                <div class="progress-value" id="hourPercent">--%</div>
            </div>
            <div class="progress-details">
                <span id="hourStart">--:00ã‹ã‚‰</span>
                <span id="hourProgress">--åˆ†çµŒé</span>
                <span id="hourRemaining">æ®‹ã‚Š--åˆ†</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar hour" id="hourBar" style="width: 0%">
                    <div class="shine"></div>
                </div>
                <div class="milestones">
                    <div class="milestone quarter"></div>
                    <div class="milestone half"></div>
                    <div class="milestone three-quarter"></div>
                </div>
            </div>
        </div>
        
        <div class="progress-card" style="background: rgba(102, 126, 234, 0.1); border: 1px solid rgba(102, 126, 234, 0.3);">
            <div class="progress-header">
                <div class="progress-title">
                    <span class="progress-icon">ğŸ¯</span>
                    <span id="targetTitle">ç›®æ¨™æ—¥æ™‚</span>
                </div>
                <div class="progress-value" id="targetPercent">--%</div>
            </div>
            <div class="progress-details" style="margin-bottom: 15px;">
                <span id="targetStart">é–‹å§‹æ—¥æ™‚</span>
                <span id="targetProgress">--çµŒé</span>
                <span id="targetRemaining">æ®‹ã‚Š--</span>
            </div>
            
            <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-bottom: 20px;">
                <input type="datetime-local" id="targetStartDateInput" class="form-input">
                <span style="opacity: 0.8;">â†’</span>
                <input type="datetime-local" id="targetEndDateInput" class="form-input">
                <button id="setTargetBtn" class="form-button">è¨­å®š</button>
            </div>
            
            <div class="progress-bar-container" id="targetContainer" style="display: none; margin-top: 15px;">
                <div class="progress-bar target" id="targetBar" style="width: 0%; background: linear-gradient(90deg, #A8E6CF, #FFD3B6);">
                    <div class="shine"></div>
                </div>
                <div class="milestones">
                    <div class="milestone quarter"></div>
                    <div class="milestone half"></div>
                    <div class="milestone three-quarter"></div>
                </div>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="yearDay">---</div>
                <div class="stat-label" id="yearDayLabel">ä»Šå¹´ã®æ—¥æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="weekNumber">--</div>
                <div class="stat-label" id="weekNumberLabel">ä»Šå¹´ã®é€±ç•ªå·</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="dayOfWeek">--</div>
                <div class="stat-label" id="dayOfWeekLabel">æ›œæ—¥</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalMinutes">----</div>
                <div class="stat-label" id="totalMinutesLabel">ä»Šæ—¥ã®çµŒéåˆ†æ•°</div>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
            <script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script>
            <script type='text/javascript'>kofiwidget2.init('Support me on Ko-fi', '#72a4f2', 'L4L61PTJ5F');kofiwidget2.draw();</script>
        </div>
    </div>

    <script>
        // è¨€èªè¨­å®š
        const translations = {
            ja: {
                title: 'ğŸ“Š æ™‚é–“ã®çµŒé',
                year: 'ä»Šå¹´',
                month: 'ä»Šæœˆ',
                week: 'ä»Šé€±', 
                day: 'ä»Šæ—¥',
                hour: 'ç¾åœ¨ã®æ™‚é–“',
                target: 'ç›®æ¨™æ—¥æ™‚',
                fromJan: '1æœˆ1æ—¥ã‹ã‚‰',
                fromMonthStart: 'æœˆ1æ—¥ã‹ã‚‰',
                fromMonday: 'æœˆæ›œã‹ã‚‰',
                fromSunday: 'æ—¥æ›œã‹ã‚‰',
                fromSaturday: 'åœŸæ›œã‹ã‚‰',
                fromMidnight: '0:00ã‹ã‚‰',
                fromHourStart: ':00ã‹ã‚‰',
                daysElapsed: 'æ—¥çµŒé',
                hoursElapsed: 'æ™‚é–“çµŒé',
                minutesElapsed: 'åˆ†çµŒé',
                daysRemaining: 'æ®‹ã‚Šæ—¥',
                hoursRemaining: 'æ®‹ã‚Šæ™‚é–“',
                minutesRemaining: 'æ®‹ã‚Šåˆ†',
                dayOfYear: 'ä»Šå¹´ã®æ—¥æ•°',
                weekOfYear: 'ä»Šå¹´ã®é€±ç•ªå·',
                dayOfWeek: 'æ›œæ—¥',
                minutesToday: 'ä»Šæ—¥ã®çµŒéåˆ†æ•°',
                weekdays: ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'],
                months: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'],
                weekStartLabel: 'é€±ã®é–‹å§‹æ›œæ—¥:',
                monday: 'æœˆæ›œæ—¥',
                sunday: 'æ—¥æ›œæ—¥',
                saturday: 'åœŸæ›œæ—¥',
                setTarget: 'è¨­å®š',
                targetNotSet: 'ç›®æ¨™ã‚’è¨­å®šã—ã¦ãã ã•ã„',
                elapsed: 'çµŒé',
                remaining: 'æ®‹ã‚Š',
                completed: 'å®Œäº†'
            },
            en: {
                title: 'ğŸ“Š Time Progress',
                year: 'This Year',
                month: 'This Month',
                week: 'This Week',
                day: 'Today',
                hour: 'Current Hour',
                target: 'Target Date',
                fromJan: 'From Jan 1',
                fromMonthStart: 'From 1st',
                fromMonday: 'From Monday',
                fromSunday: 'From Sunday', 
                fromSaturday: 'From Saturday',
                fromMidnight: 'From 0:00',
                fromHourStart: ':00',
                daysElapsed: 'days elapsed',
                hoursElapsed: 'hours elapsed',
                minutesElapsed: 'min elapsed',
                daysRemaining: 'days left',
                hoursRemaining: 'hours left',
                minutesRemaining: 'min left',
                dayOfYear: 'Day of Year',
                weekOfYear: 'Week Number',
                dayOfWeek: 'Day of Week',
                minutesToday: "Today's Minutes",
                weekdays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                weekStartLabel: 'Week starts on:',
                monday: 'Monday',
                sunday: 'Sunday',
                saturday: 'Saturday',
                setTarget: 'Set',
                targetNotSet: 'Set your target date',
                elapsed: 'elapsed',
                remaining: 'remaining',
                completed: 'Completed'
            }
        };
        
        // çŠ¶æ…‹å¤‰æ•°ã®åˆæœŸåŒ–
        let currentLang = 'ja';
        let weekStartDay = 1; // 1 = Monday, 0 = Sunday, 6 = Saturday
        let targetStartDate = null;
        let targetEndDate = null;
        
        // â­ 1. URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨LocalStrageã‹ã‚‰è¨­å®šã‚’èª­ã¿è¾¼ã‚€
        function loadSettings() {
            const params = new URLSearchParams(window.location.search);
            
            // è¨€èªè¨­å®šã®èª­ã¿è¾¼ã¿ (URL > LocalStorage > Default)
            const urlLang = params.get('lang');
            const localLang = localStorage.getItem('lang');
            if (urlLang && translations[urlLang]) {
                currentLang = urlLang;
            } else if (localLang && translations[localLang]) {
                currentLang = localLang;
            }
            
            // é€±ã®é–‹å§‹æ›œæ—¥ã®èª­ã¿è¾¼ã¿ (URL > LocalStorage > Default)
            const urlWeekStart = params.get('weekStart');
            const localWeekStart = localStorage.getItem('weekStart');
            if (urlWeekStart !== null && ['0', '1', '6'].includes(urlWeekStart)) {
                weekStartDay = parseInt(urlWeekStart);
            } else if (localWeekStart !== null && ['0', '1', '6'].includes(localWeekStart)) {
                weekStartDay = parseInt(localWeekStart);
            }
            
            // Selectãƒœãƒƒã‚¯ã‚¹ã®å€¤ã‚’è¨­å®šã«åˆã‚ã›ã‚‹
            document.getElementById('weekStartDay').value = weekStartDay.toString();
        }
        
        // â­ 2. LocalStorageã«è¨­å®šã‚’ä¿å­˜ã—ã€URLã‚’æ›´æ–°ã™ã‚‹
        function saveSettings(updateUrl = true) {
            // LocalStorageä¿å­˜
            localStorage.setItem('lang', currentLang);
            localStorage.setItem('weekStart', weekStartDay.toString());
            
            // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°
            if (updateUrl) {
                const url = new URL(window.location.href);
                url.searchParams.set('lang', currentLang);
                url.searchParams.set('weekStart', weekStartDay.toString());
                window.history.replaceState({}, '', url.toString());
            }
        }
        
        function updateLanguage() {
            const t = translations[currentLang];
            document.getElementById('title').textContent = t.title;
            // Titles are now updated dynamically in updateTimeProgress
            document.getElementById('targetTitle').textContent = t.target;
            document.getElementById('yearDayLabel').textContent = t.dayOfYear;
            document.getElementById('weekNumberLabel').textContent = t.weekOfYear;
            document.getElementById('dayOfWeekLabel').textContent = t.dayOfWeek;
            document.getElementById('totalMinutesLabel').textContent = t.minutesToday;
            document.getElementById('weekStartLabel').textContent = t.weekStartLabel;
            document.getElementById('setTargetBtn').textContent = t.setTarget;
            document.getElementById('langBtn').textContent = currentLang === 'ja' ? 'ğŸŒ English' : 'ğŸŒ æ—¥æœ¬èª';
            
            // Update week start day options
            const weekStartSelect = document.getElementById('weekStartDay');
            weekStartSelect.options[0].text = t.monday;
            weekStartSelect.options[1].text = t.sunday;
            weekStartSelect.options[2].text = t.saturday;
            
            // Update HTML lang attribute for SEO/Accessibility
            document.documentElement.lang = currentLang;
        }
        
        function getWeekNumber(date) {
            const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
            const dayNum = d.getUTCDay() || 7;
            d.setUTCDate(d.getUTCDate() + 4 - dayNum);
            const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
            return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
        }
        
        function getDaysInMonth(year, month) {
            return new Date(year, month + 1, 0).getDate();
        }
        
        function getDayOfYear(date) {
            const start = new Date(date.getFullYear(), 0, 0);
            const diff = date - start;
            return Math.floor(diff / (1000 * 60 * 60 * 24));
        }
        
        function formatTimeRemaining(milliseconds) {
            const t = translations[currentLang];
            const totalSeconds = Math.floor(milliseconds / 1000);
            const totalDays = Math.floor(totalSeconds / (60 * 60 * 24));
            const hours = Math.floor((totalSeconds % (60 * 60 * 24)) / (60 * 60));
            const minutes = Math.floor((totalSeconds % (60 * 60)) / 60);
            
            if (totalDays > 0) {
                // daysRemaining/hoursRemaining/minutesRemainingã®å…ˆé ­ã®ã€Œæ®‹ã‚Šã€ã‚’å‰Šé™¤
                const dayLabel = t.daysRemaining.replace(t.remaining, '').trim();
                const hourLabel = t.hoursRemaining.replace(t.remaining, '').trim();
                return `${totalDays}${dayLabel} ${hours}${hourLabel}`;
            } else if (hours > 0) {
                const hourLabel = t.hoursRemaining.replace(t.remaining, '').trim();
                const minuteLabel = t.minutesRemaining.replace(t.remaining, '').trim();
                return `${hours}${hourLabel} ${minutes}${minuteLabel}`;
            } else {
                const minuteLabel = t.minutesRemaining.replace(t.remaining, '').trim();
                return `${minutes}${minuteLabel}`;
            }
        }
        
        function updateTimeProgress() {
            const now = new Date();
            const t = translations[currentLang];
            
            // ç¾åœ¨æ™‚åˆ»ã®è¡¨ç¤º
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const seconds = now.getSeconds();
            const timeStr = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('currentTime').textContent = timeStr;
            
            // æ—¥ä»˜ã®è¡¨ç¤º
            const year = now.getFullYear();
            const month = now.getMonth();
            const date = now.getDate();
            const weekday = now.getDay();
            
            if (currentLang === 'ja') {
                document.getElementById('currentDate').textContent = 
                    `${year}å¹´${month + 1}æœˆ${date}æ—¥ï¼ˆ${t.weekdays[weekday]}ï¼‰`;
            } else {
                document.getElementById('currentDate').textContent = 
                    `${t.months[month]} ${date}, ${year} (${t.weekdays[weekday]})`;
            }
            
            // å¹´ã®é€²æ—
            const yearStart = new Date(year, 0, 1);
            const yearEnd = new Date(year + 1, 0, 1);
            const yearTotal = yearEnd - yearStart;
            const yearElapsed = now - yearStart;
            const yearPercent = Math.min(100, Math.max(0, Math.floor((yearElapsed / yearTotal) * 100)));
            const daysInYear = getDayOfYear(now);
            const daysRemainingInYear = (yearEnd - now) / (1000 * 60 * 60 * 24);
            
            // Update year title with specific year
            const yearTitleText = currentLang === 'ja' ? `${year}å¹´ã®é€²æ—` : `${year} Progress`;
            document.getElementById('yearTitle').textContent = yearTitleText;
            document.getElementById('yearPercent').textContent = `${yearPercent}%`;
            document.getElementById('yearBar').style.width = `${yearPercent}%`;
            document.getElementById('yearStart').textContent = t.fromJan;
            document.getElementById('yearProgress').textContent = `${daysInYear} ${t.daysElapsed}`;
            document.getElementById('yearRemaining').textContent = `${Math.ceil(daysRemainingInYear)} ${t.daysRemaining}`;
            
            // æœˆã®é€²æ—
            const monthStart = new Date(year, month, 1);
            const monthEnd = new Date(year, month + 1, 1);
            const monthTotal = monthEnd - monthStart;
            const monthElapsed = now - monthStart;
            const monthPercent = Math.min(100, Math.max(0, Math.floor((monthElapsed / monthTotal) * 100)));
            const daysInCurrentMonth = getDaysInMonth(year, month);
            const daysRemainingInMonth = daysInCurrentMonth - date;
            
            // Update month title with specific month
            const monthTitleText = currentLang === 'ja' ? `${month + 1}æœˆã®é€²æ—` : `${t.months[month]} Progress`;
            document.getElementById('monthTitle').textContent = monthTitleText;
            document.getElementById('monthPercent').textContent = `${monthPercent}%`;
            document.getElementById('monthBar').style.width = `${monthPercent}%`;
            document.getElementById('monthStart').textContent = currentLang === 'ja' ? 
                `${month + 1}${t.fromMonthStart}` : `${t.fromMonthStart}`;
            document.getElementById('monthProgress').textContent = `${date} ${t.daysElapsed}`;
            document.getElementById('monthRemaining').textContent = `${daysRemainingInMonth} ${t.daysRemaining}`;
            
            // é€±ã®é€²æ—ï¼ˆã‚«ã‚¹ã‚¿ãƒ é–‹å§‹æ›œæ—¥ï¼‰
            weekStartDay = parseInt(document.getElementById('weekStartDay').value);
            const currentDayOfWeek = weekday;
            let daysFromWeekStart;
            
            if (weekStartDay === 0) { // Sunday start (0)
                daysFromWeekStart = currentDayOfWeek;
            } else if (weekStartDay === 1) { // Monday start (1)
                daysFromWeekStart = currentDayOfWeek === 0 ? 6 : currentDayOfWeek - 1;
            } else if (weekStartDay === 6) { // Saturday start (6)
                daysFromWeekStart = (currentDayOfWeek + 1) % 7;
            }
            
            const weekStart = new Date(now);
            weekStart.setDate(date - daysFromWeekStart);
            weekStart.setHours(0, 0, 0, 0);
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekStart.getDate() + 7);
            const weekTotal = weekEnd - weekStart;
            const weekElapsed = now - weekStart;
            const weekPercent = Math.min(100, Math.max(0, Math.floor((weekElapsed / weekTotal) * 100)));
            const daysElapsedInWeek = Math.floor(weekElapsed / (1000 * 60 * 60 * 24));
            const daysRemainingInWeek = 7 - daysElapsedInWeek;
            
            document.getElementById('weekPercent').textContent = `${weekPercent}%`;
            document.getElementById('weekBar').style.width = `${weekPercent}%`;
            
            // Update week start label based on selected day
            if (weekStartDay === 0) {
                document.getElementById('weekStart').textContent = t.fromSunday;
            } else if (weekStartDay === 1) {
                document.getElementById('weekStart').textContent = t.fromMonday;
            } else if (weekStartDay === 6) {
                document.getElementById('weekStart').textContent = t.fromSaturday;
            }
            
            document.getElementById('weekProgress').textContent = `${daysElapsedInWeek} ${t.daysElapsed}`;
            document.getElementById('weekRemaining').textContent = `${daysRemainingInWeek} ${t.daysRemaining}`;
            
            // Week title remains static
            document.getElementById('weekTitle').textContent = t.week;
            
            // æ—¥ã®é€²æ—
            const dayStart = new Date(year, month, date, 0, 0, 0);
            const dayEnd = new Date(year, month, date + 1, 0, 0, 0);
            const dayTotal = dayEnd - dayStart;
            const dayElapsed = now - dayStart;
            const dayPercent = Math.min(100, Math.max(0, Math.floor((dayElapsed / dayTotal) * 100)));
            const hoursElapsed = Math.floor(dayElapsed / (1000 * 60 * 60));
            const hoursRemaining = 24 - hoursElapsed;
            
            // Update day title with specific date
            const dayTitleText = currentLang === 'ja' ? `${date}æ—¥ã®é€²æ—` : `${t.months[month]} ${date} Progress`;
            document.getElementById('dayTitle').textContent = dayTitleText;
            document.getElementById('dayPercent').textContent = `${dayPercent}%`;
            document.getElementById('dayBar').style.width = `${dayPercent}%`;
            document.getElementById('dayStart').textContent = t.fromMidnight;
            document.getElementById('dayProgress').textContent = `${hoursElapsed} ${t.hoursElapsed}`;
            document.getElementById('dayRemaining').textContent = `${hoursRemaining} ${t.hoursRemaining}`;
            
            // æ™‚é–“ã®é€²æ—
            const hourStart = new Date(year, month, date, hours, 0, 0);
            const hourEnd = new Date(year, month, date, hours + 1, 0, 0);
            const hourTotal = hourEnd - hourStart;
            const hourElapsed = now - hourStart;
            const hourPercent = Math.min(100, Math.max(0, Math.floor((hourElapsed / hourTotal) * 100)));
            const minutesElapsed = Math.floor(hourElapsed / (1000 * 60));
            const minutesRemaining = 60 - minutesElapsed;
            
            // Update hour title with specific hour
            const hourTitleText = currentLang === 'ja' ? `${hours}æ™‚ã®é€²æ—` : `${hours}:00 Progress`;
            document.getElementById('hourTitle').textContent = hourTitleText;
            document.getElementById('hourPercent').textContent = `${hourPercent}%`;
            document.getElementById('hourBar').style.width = `${hourPercent}%`;
            document.getElementById('hourStart').textContent = `${hours}${t.fromHourStart}`;
            document.getElementById('hourProgress').textContent = `${minutesElapsed} ${t.minutesElapsed}`;
            document.getElementById('hourRemaining').textContent = `${minutesRemaining} ${t.minutesRemaining}`;
            
            // ã‚«ã‚¹ã‚¿ãƒ ç›®æ¨™æ—¥æ™‚ã®é€²æ—
            if (targetStartDate && targetEndDate) {
                const targetTotal = targetEndDate - targetStartDate;
                const targetElapsed = now - targetStartDate;
                
                // æœŸé–“ãŒã‚¼ãƒ­ã¾ãŸã¯è² ã®å ´åˆã¯ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
                if (targetTotal <= 0) {
                    document.getElementById('targetContainer').style.display = 'none';
                    document.getElementById('targetStart').textContent = 'âš ï¸ ç„¡åŠ¹ãªæœŸé–“';
                    document.getElementById('targetPercent').textContent = '--%';
                    document.getElementById('targetProgress').textContent = '';
                    document.getElementById('targetRemaining').textContent = '';
                    return;
                }
                
                const targetPercent = Math.min(100, Math.max(0, Math.floor((targetElapsed / targetTotal) * 100)));
                const targetRemaining = targetEndDate - now;
                
                document.getElementById('targetContainer').style.display = 'block';
                document.getElementById('targetPercent').textContent = `${targetPercent}%`;
                document.getElementById('targetBar').style.width = `${targetPercent}%`;
                
                // Format start and end dates
                const startStr = `${targetStartDate.getMonth() + 1}/${targetStartDate.getDate()} ${targetStartDate.getHours().toString().padStart(2, '0')}:${targetStartDate.getMinutes().toString().padStart(2, '0')}`;
                document.getElementById('targetStart').textContent = `ğŸ¯ ${startStr} â†’`;
                
                // Calculate elapsed and remaining
                if (targetPercent >= 100) {
                    // å®Œäº†
                    document.getElementById('targetProgress').textContent = t.elapsed;
                    document.getElementById('targetRemaining').textContent = t.completed;
                    document.getElementById('targetBar').style.background = 'linear-gradient(90deg, #4ECDC4, #A8E6CF)'; // Completed color
                } else if (targetPercent <= 0 && targetElapsed < 0) {
                     // é–‹å§‹å‰
                     const remainingTime = targetStartDate - now;
                     document.getElementById('targetProgress').textContent = `${t.remaining} ${formatTimeRemaining(remainingTime)}`;
                     document.getElementById('targetRemaining').textContent = t.elapsed;
                     document.getElementById('targetBar').style.background = 'linear-gradient(90deg, #F4A261, #FFD3B6)'; // Pre-start color
                     document.getElementById('targetBar').style.width = '0%'; // é–‹å§‹å‰ã¯0%
                } else {
                    // é€²è¡Œä¸­
                    const elapsedDays = Math.floor(targetElapsed / (1000 * 60 * 60 * 24));
                    document.getElementById('targetProgress').textContent = `${elapsedDays}${t.daysElapsed.replace('çµŒé', '').trim()} ${t.elapsed}`;
                    document.getElementById('targetRemaining').textContent = `${t.remaining} ${formatTimeRemaining(targetRemaining)}`;
                    document.getElementById('targetBar').style.background = 'linear-gradient(90deg, #A8E6CF, #FFD3B6)'; // In-progress color
                }
            } else {
                document.getElementById('targetContainer').style.display = 'none';
                document.getElementById('targetStart').textContent = t.targetNotSet;
                document.getElementById('targetPercent').textContent = '--%';
                document.getElementById('targetProgress').textContent = '';
                document.getElementById('targetRemaining').textContent = '';
            }
            
            // çµ±è¨ˆæƒ…å ±
            const daysInCurrentYear = new Date(year, 11, 31) - yearStart;
            document.getElementById('yearDay').textContent = `${daysInYear}/${Math.ceil(daysInCurrentYear / (1000 * 60 * 60 * 24))}`; // æ—¥æ•°
            document.getElementById('weekNumber').textContent = getWeekNumber(now);
            document.getElementById('dayOfWeek').textContent = t.weekdays[weekday];
            document.getElementById('totalMinutes').textContent = hours * 60 + minutes;
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.getElementById('langBtn').addEventListener('click', () => {
            currentLang = currentLang === 'ja' ? 'en' : 'ja';
            saveSettings(); // è¨­å®šä¿å­˜
            updateLanguage();
            updateTimeProgress();
        });
        
        document.getElementById('weekStartDay').addEventListener('change', (e) => {
            weekStartDay = parseInt(e.target.value);
            saveSettings(); // è¨­å®šä¿å­˜
            updateTimeProgress();
        });
        
        // â­ IDä¿®æ­£æ¸ˆã¿ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä½¿ç”¨
        document.getElementById('setTargetBtn').addEventListener('click', () => {
            const startInput = document.getElementById('targetStartDateInput').value;
            const endInput = document.getElementById('targetEndDateInput').value;
            
            if (startInput && endInput) {
                targetStartDate = new Date(startInput);
                targetEndDate = new Date(endInput);
                
                // LocalStorageã«ç›®æ¨™ã‚’ä¿å­˜ã™ã‚‹ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
                localStorage.setItem('targetStartDate', startInput);
                localStorage.setItem('targetEndDate', endInput);
                
                updateTimeProgress();
            }
        });
        
        // æ—¥æ™‚å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°
        const formatDateForInput = (date) => {
            const year = date.getFullYear();
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            const hours = date.getHours().toString().padStart(2, '0');
            const minutes = date.getMinutes().toString().padStart(2, '0');
            return `${year}-${month}-${day}T${hours}:${minutes}`;
        };
        
        // åˆæœŸåŒ–å‡¦ç†
        (function initialize() {
            // 1. è¨­å®šã®ãƒ­ãƒ¼ãƒ‰
            loadSettings();
            
            // 2. ã‚«ã‚¹ã‚¿ãƒ ç›®æ¨™ã®LocalStorageã‹ã‚‰ã®å¾©å…ƒ
            const savedStart = localStorage.getItem('targetStartDate');
            const savedEnd = localStorage.getItem('targetEndDate');
            
            // 3. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¾ãŸã¯å¾©å…ƒå€¤ã‚’ã‚»ãƒƒãƒˆ
            const now = new Date();
            const tomorrow = new Date(now);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            document.getElementById('targetStartDateInput').value = savedStart || formatDateForInput(now);
            document.getElementById('targetEndDateInput').value = savedEnd || formatDateForInput(tomorrow);
            
            if (savedStart && savedEnd) {
                targetStartDate = new Date(savedStart);
                targetEndDate = new Date(savedEnd);
            }
            
            // 4. è¨€èªã¨é€²æ—ã®åˆå›æ›´æ–°
            updateLanguage();
            updateTimeProgress();
            
            // 5. 1ç§’ã”ã¨ã«æ›´æ–°
            setInterval(updateTimeProgress, 1000);
        })();
    </script>
</body>
</html>
